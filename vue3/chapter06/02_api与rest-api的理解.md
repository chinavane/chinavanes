# 02.api 与 rest api 的理解

## 1)api 与 rest api 的基本概念

在进行 Vue 的数据请求实际操作之前我想还需要强化几个非常重要的概念，比如什么是 rest api，这样才能更好的理解请求的原理与具体的操作方法，否则对于请求的应用只能是知其然不知其所以然。

那么什么是 rest api，我们又为什么需要使用它呢？事实上并不是每一个项目都会涉及到 html 的用户界面操作的，比如说移动端的项目像京东、淘宝的 APP，这些项目就没有涉及到 HTML 的生成显示操作，它们利用 java 或者是 object c 以及 swift 进行原生 app 的项目开发操作，而你所看到的用户界面的内容都是由 apple 或者 google 公司所提供的 UI 类库实现，并且它们进行开发的工具也不是 vscode 可能是 android studio 或者是 xcode 等。现在的项目其应用的界面和服务器端的操作通常是解耦处理的，我们并不一定要有 html 代码内容，因为也可能并不需要它们，而他们对于数据的操作与显示都是通过与后端的 API 进行衔接才能够正常应用。

还有一些项目是 SPA 项目（single page application）单页面应用，这个就是我们当前 Vue 项目所归属的具体类型。这些应用程序并不是每一次操作都会进行页面的渲染操作，事实上它们叫单页面应用是有原因的，基本上它们的页面数量只有一个，那么又怎么实现数据的衔接处理呢？对于用户的添加、修改、删除以及查询又需要通过什么方式解决呢。通常他们也会进行 API 接口的请求操作，将返回的结果应用到当前的项目中去。

还有一些 APIs 服务的提供商，比如说百度地图，在使用它们的时候其实也并不需要返回 HTML 页面的显示内容，因为我们只需要获取到对应地图目标的坐标位置，经度维度的值就可以了。

总得来说，我们现在获取到一个需求是前台的显示与后端的逻辑出现了分离的操作。那么又应该怎么实现这一目标操作呢？

我们刚才不断的听到有 API、API 的概念，那么什么是 API?

API（Application Programming Interface,应用程序编程接口）是一些预先定义的函数，目的是提供应用程序与开发人员基于某软件或硬件得以访问一组例程的能力，而又无需访问源码，或理解内部工作机制的细节。

这样说吧，比如说我们有一个可以允许我们查看（view），创建（create），编辑（edit）以及删除（delete）部件的应用程序。我们可以创建一个可以让我们执行这些功能的 HTTP API:

当人们开始去实现他们自己的 API 接口时，问题就出现了。竟然没有一个标准的方法来命名 URL，人们总是要参考 API 才得知它是如何运作的。一个 API 中可能命名一个 URL 为/view_users，但是另一个 API 可能就命名成/users/all。

正是因为 API 的这种混乱的情况，所以需要有一个解决的方案，因而 rest 的诞生进行了对 API 更好的一种约束。

什么是 rest 呢?

rest 是 Representational State Transfer（表现层状态转移）的缩写，它是由罗伊·菲尔丁（Roy Fielding）提出的，是用来描述创建 HTTP API 的标准方法的，他发现这四种常用的行为（查看（view），创建（create），编辑（edit）和删除（delete））都可以直接映射到 HTTP 中已实现的 GET、POST、PUT 和 DELETE 方法。

HTTP 中的 8 中不同的方法：

![vue3-book-08.HTTP中的8中不同的方法](http://qn.chinavanes.com/qiniu_picGo/vue3-book-08.HTTP%E4%B8%AD%E7%9A%848%E4%B8%AD%E4%B8%8D%E5%90%8C%E7%9A%84%E6%96%B9%E6%B3%95.png)

![vue3-book-09.REST例子](http://qn.chinavanes.com/qiniu_picGo/vue3-book-09.REST%E4%BE%8B%E5%AD%90.png)

![vue3-book-12.不仅仅只有GET与POST请求](http://qn.chinavanes.com/qiniu_picGo/vue3-book-12.%E4%B8%8D%E4%BB%85%E4%BB%85%E5%8F%AA%E6%9C%89GET%E4%B8%8EPOST%E8%AF%B7%E6%B1%82.png)

让我们来解剖 rest url。你可能已经注意的前面的几个例子，rest url 使用着一套一致的命名方法。当你跟 API 交互时，你几乎经常操作一些对象。在我们的例子中，我们讲的是用户。在 rest 中，我们称之为 Resource。URL 的第一部分经常是这个资源的复数形式：/users

当我们参考收集的资源时（list all：列出所有和 add one：新增一个），这将会经常用到。当你用到一些特殊的资源的时候，你就会给 URL 增加一个 id，这个 URL 在你想要“view”，“edit”和“delete”特殊资源的时候会被使用。

所以我们对 rest API 做一个详情的总结：

一、rest api 是前后端分离最佳实践，是开发的一套标准或者说是一套规范，不是框架。

1、轻量，直接通过 http，不需要额外的协议，通常有 post、get、put、deletec 操作；
2、面向资源，一目了然，具有自解释性；
3、数据描述简单，一般通过 json 或者 xml 做数据通讯。

二、rest 全称

即 Representational State Transfer 的缩写，我对这个词组的翻译是"表现层状态转化"。

三、资源（Resources）

rest 的名称"表现层状态转化"中，省略了主语。"表现层"其实指的是"资源"（Resources）的"表现层"。

所谓"资源"，就是网络上的一个实体，或者说是网络上的一个具体信息。它可以是一段文本、一张图片、一首歌曲、一种服务，总之就是一个具体的实在。你可以用一个 URI（统一资源定位符）指向它，每种资源对应一个特定的 URI。要获取这个资源，访问它的 URI 就可以，因此 URI 就成了每一个资源的地址或独一无二的识别符。

所谓"上网"，就是与互联网上一系列的"资源"互动，调用它的 URI。

四、表现层（Representation）

"资源"是一种信息实体，它可以有多种外在表现形式。我们把"资源"具体呈现出来的形式，叫做它的"表现层"（Representation）。

比如，文本可以用 txt 格式表现，也可以用 HTML 格式、XML 格式、JSON 格式表现，甚至可以采用二进制格式；图片可以用 JPG 格式表现，也可以用 PNG 格式表现。

URI 只代表资源的实体，不代表它的形式。严格地说，有些网址最后的".html"后缀名是不必要的，因为这个后缀名表示格式，属于"表现层"范畴，而 URI 应该只代表"资源"的位置。它的具体表现形式，应该在 HTTP 请求的头信息中用 Accept 和 Content-Type 字段指定，这两个字段才是对"表现层"的描述。

五、状态转化（State Transfer）

访问一个网站，就代表了客户端和服务器的一个互动过程。在这个过程中，势必涉及到数据和状态的变化。

互联网通信协议 HTTP 协议，是一个无状态协议。这意味着，所有的状态都保存在服务器端。因此，如果客户端想要操作服务器，必须通过某种手段，让服务器端发生"状态转化"（State Transfer）。而这种转化是建立在表现层之上的，所以就是"表现层状态转化"。

客户端用到的手段，只能是 HTTP 协议。具体来说，就是 HTTP 协议里面，四个表示操作方式的动词：GET、POST、PUT、DELETE。它们分别对应四种基本操作：GET 用来获取资源，POST 用来新建资源（也可以用于更新资源），PUT 用来更新资源，DELETE 用来删除资源。

六、综述

综合上面的解释，我们总结一下什么是 RESTful 架构：
（1）每一个 URI 代表一种资源；
（2）客户端和服务器之间，传递这种资源的某种表现层；
（3）客户端通过四个 HTTP 动词，对服务器端资源进行操作，实现"表现层状态转化"。

## 2)rest api 操作方式

因此，既然我们知道了 rest api 通常是什么，或者它可以解决什么问题，让我对它的工作原理有一个大致了解。我们现在正在处理一个 Vue 的 SPA 单页面项目，项目中绝大多数操作将不涉及到 HTML 的内容体系，因为界面部分的内容都已经利用页面与组件的方式进行前期处理，但他们可能都需要从公司的统一一个后台的服务接口进行数据的请求与响应操作，而公司的统一的后台系统也将给当前的项目提供统一的数据内容，并且在这一过程中还有可能去衔接第三方的 API 服务商接口内容，比如说之前提的百度地图接口。那么，Vue 这个单页面项目与后台进行的是怎么样的对接操作呢？我想只关乎数据，不关乎界面的内容。

![vue3-book-10.REST-API操作方式](http://qn.chinavanes.com/qiniu_picGo/vue3-book-10.REST-API%E6%93%8D%E4%BD%9C%E6%96%B9%E5%BC%8F.png)

这里就涉及到数据的问题，而数据又涉及到很多的数据格式，比如 HTML 格式、纯文本格式，XML 文件，JSON 数据文件等。

我想可以对这些数据文件及格式做一个简要的对比说明，以便明确 rest api 到底更适合与哪种进行配合使用。

HTML 是带有 html 标签的页面内容，其中的数据被嵌套于 html 的标签之中，整个页面信息包含了数据以及页面展示的结构，如果我们只是想要获取到页面中的数据话很难进行解析处理。而存文本虽然数据格式极其精简，但过于精简导致没有了清晰的数据结构，我们只关注数据，但事实上这个数据内容是很难解析获取的。而 XML 文件在以前是一种数据交换的格式文件，但这种格式文件的虽然有较好的可读性，可是代码冗余太大，往往造成一个交互文件占用很大流量的问题，而且对它进行解析的时候需要利用 xmlParse 进行处理才行。至于 JSON，它更关注于数据，不强调 UI 界面内容，具备高度的可读性，而且数据精减，最为关键的是它与 javascript 对象很相似，而且也极其容易的进行转化操作。

![vue3-book-11.数据格式](http://qn.chinavanes.com/qiniu_picGo/vue3-book-11.%E6%95%B0%E6%8D%AE%E6%A0%BC%E5%BC%8F.png)

由此看来，JSON 数据格式应该是我们进行 RESE api 项目开发时数据交换格式的首选目标了。

## 3)rest 核心原则

rest 在操作时有一些基本的原则：

- 使用 HTTP 动词：GET、POST、PUT、DELETE 等，从名称转向动词，而动词的内容相对比较固定，这就让开发与应用人员有了一个统一的约束，从理解与应用都更为的明确；
- 统计设计标准：为每个资源设置 URI 清晰的定义 API 的路由指向以及明确定义请求与响应的数据格式，这样为后续沟通减少大量的时间成本；
- 无状态连接：服务器端不应保存过多上下文状态，即每个请求都是独立的，客户端及服务器端都不会保留连接的状态，也就是每次请求都是分离操作；
- 服务器可以设置缓存操作，而客户端接收到的也可以是缓存数据。客户端与服务器端是分离的，而客户端并不会关注数据的存储以及持久化等处理，服务器端也会进行其它 API 请求处理，而只有客户端请求时，服务器端才会执行代码返回结果；
- 通过 XML JSON 等数据格式进行数据传递，但事实上介于数据可读性、易操作性等因素，建议还是直接使用 JSON 数据进行数据传递。

![vue3-book-13.REST核心原则](http://qn.chinavanes.com/qiniu_picGo/vue3-book-13.REST%E6%A0%B8%E5%BF%83%E5%8E%9F%E5%88%99.png)
