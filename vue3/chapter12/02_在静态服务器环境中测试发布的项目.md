# 02.在静态服务器环境中测试发布的项目

项目环境在开发模式下可以在当前设备中进行直接开发运行操作，可以打开`http://localhost:5173`等地址就可以实现项目运行结果的查看。但是如果项目已经开发完毕的情况下则需要运行`npm run build`进行打包构建操作。在运行完该命令以后通常会在项目的根目录产生一个dist的子目录，而dist的全称其实是distribution也就是发行版本目录的意思。因为是最终发布的发行版本，所以dist目录下的css以及js等资源文件因为性能和安全需求的目标会被进行代码的压缩与代码混淆操作。其中的代码会被去除空格、注释等内容，只留下一整行代码内容，而且项目中的变量等内容会被更短的字符给替换以确认代码内容的“加密”性。

对于dist这个发行版本目录需要如何运行呢？其实有很多的方式可以实现。假若现在仅仅作为前端开发人员在完成项目代码开发并实现项目的打包构建以后，建议是将当前的项目在本地设备上进行一个运行的测试。但这时候发行版本目录dist是需要有服务器模式进行支撑的，因为最终我们的项目也需要托管到类似于阿里云、腾讯云、百度云这样的云服务器上，只不过我们对这些服务器相关内容并不熟悉的情况下，只能在本地实现一个类似的“服务器运行环境”先行进行尝试。

对于“服务器运行环境”的构建可以先了解一些静态服务器的知识内容，在github.com中可以搜索到很多的静态服务器支撑模块，比如[serve](https://github.com/vercel/serve)、[http-server](https://github.com/http-party/http-server)、[live-server](https://github.com/tapio/live-server)等，那么可以对这些模块先行进行全局安装，比如：

```bash
npm install --global serve
```

```bash
npm install --global http-server
```

```bash
npm install --global live-server
```

然后可以先将当前操作目录切换到dist子目录下，也就是终端命令：

```bash
cd dist
```

然后可以直接在终端中运行命令`serve`就可以启动当前发行版本的项目，并且在浏览器中可以进行查看：

```
serve
```

![image-20220825100849158](http://qn.chinavanes.com/qiniu_picGo/image-20220825100849158.png)

现在的项目运行地址是根级模式，是一级目录结构，也就是dist目录就是当前项目的运行根目录，项目中所有资源的请求都是从dist目录下的子目录内容进行获取。

其实dist这个目录所在的位置是哪并不重要，我们完全可以将dist这个目录复制粘贴到电脑的其它磁盘或者目录下，然后只需要最终切换进入到dist目录并且运行`serve`这样的本地服务器启动命令就可以对我们开发完毕的项目进行生产环境模式的测试操作。

除此之外，之前我们有介绍测试环境的命令是：

```
"test": "vite build --mode test --base=/dist/"
```

它与生产环境的区别主要在于--base基础路由的设置，也就是当前的项目不再是基于一级目录的根级项目结构，而是基于二级目录的子级项目结构。那么在我们运行`npm run test`命令以后，当前项目中的dist目录将会被先行清除，并且根据test环境的内容进行项目的重新构建，并且将构建后的代码仍旧生成到dist目录当中。只不过，现在的dist其实是test测试环境，不再是production生成环境了。

因为当前测试环境将要实现的是二级目录的项目，所以还能不能进入dist子目录了呢？显然是不能的，现在需要在当前项目中直接运行`serve`来启动当前的测试项目，这时候可能发现打开`http://localhost:3000`是一个空的页面，这是因为dist目录目前是设置成了二级目录项目，所以测试的地址不再是`http://localhost:3000`而是变成了`http://localhost:3000/dist`。

所以在进行项目发布的时候一定要先明确当前项目的级别类型，到底是一级目录结构还是多级目录结构。
